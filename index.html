<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Kalender 2026 - Agenda</title>

<style>
:root{
  --primary:#1f2a7a;
  --border:#d5d9ff;
  --bg:#fafaff;
}

body{
  font-family: "Segoe UI", sans-serif;
  margin:0;
  background:var(--bg);
  color:#222;
}

.app{
  display:grid;
  grid-template-columns:260px 1fr;
  min-height:100vh;
}

/* ===== SIDEBAR ===== */
.sidebar{
  background:#fff;
  border-right:1px solid var(--border);
  padding:20px;
}

.sidebar h2{
  color:var(--primary);
  margin-bottom:10px;
}

.note{
  width:100%;
  height:120px;
  resize:none;
}

.legend div{
  display:flex;
  align-items:center;
  margin:6px 0;
  font-size:14px;
}

.color{
  width:16px;
  height:16px;
  margin-right:8px;
  border-radius:4px;
}

.bem{background:#7df9ff;}
.proker{background:#c4a7ff;}
.rapat{background:#ffe28a;}
.bulanan{background:#ffb3c6;}
.libur{background:#9cff9c;}

/* ===== MAIN ===== */
.main{
  padding:20px;
}

.header{
  display:flex;
  justify-content:space-between;
  align-items:center;
}

.header h1{
  color:var(--primary);
}

.nav button{
  padding:6px 12px;
  border:none;
  background:var(--primary);
  color:#fff;
  cursor:pointer;
  border-radius:6px;
}

.calendar{
  margin-top:20px;
}

.weekdays, .days{
  display:grid;
  grid-template-columns:repeat(7,1fr);
}

.weekdays div{
  text-align:center;
  font-weight:600;
  padding:10px 0;
}

.day{
  min-height:110px;
  border:1px solid var(--border);
  padding:6px;
  font-size:13px;
  position:relative;
  background:#fff;
}

.day span{
  font-weight:600;
}

.event{
  margin-top:4px;
  padding:2px 4px;
  border-radius:4px;
  font-size:11px;
  cursor:pointer;
}

/* ===== MODAL ===== */
.modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.4);
  display:none;
  justify-content:center;
  align-items:center;
}

.modal-content{
  background:#fff;
  padding:20px;
  width:300px;
  border-radius:10px;
}

.modal-content input,
.modal-content select{
  width:100%;
  margin-bottom:10px;
  padding:6px;
}

.modal-content button{
  margin-top:6px;
  padding:6px;
  width:100%;
}
</style>

<script type="module">
  // Import the functions you need from the SDKs you need
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
  import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-analytics.js";
  // TODO: Add SDKs for Firebase products that you want to use
  // https://firebase.google.com/docs/web/setup#available-libraries

  // Your web app's Firebase configuration
  // For Firebase JS SDK v7.20.0 and later, measurementId is optional
  const firebaseConfig = {
    apiKey: "AIzaSyAoEzN_cpkVom7m1IN5L_UsAOZO4kVEHw4",
    authDomain: "calender-b75ab.firebaseapp.com",
    projectId: "calender-b75ab",
    storageBucket: "calender-b75ab.firebasestorage.app",
    messagingSenderId: "750147920031",
    appId: "1:750147920031:web:83bac92fbbc828096ac2aa",
    measurementId: "G-3FZSJNH2LK"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const analytics = getAnalytics(app);
</script>

</head>

<body>
<!-- LOGIN -->
<div id="loginPage" style="
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
  background:#fafaff;
">
  <div style="
    background:#fff;
    padding:30px;
    width:300px;
    border-radius:12px;
    box-shadow:0 10px 30px rgba(0,0,0,.1);
  ">
    <h2 style="text-align:center;color:#1f2a7a">Login BEM</h2>
    <input id="loginEmail" placeholder="Email" style="width:100%;padding:8px;margin:8px 0">
    <input id="loginPassword" type="password" placeholder="Password" style="width:100%;padding:8px;margin:8px 0">
    <button onclick="login()" style="
      width:100%;
      padding:8px;
      background:#1f2a7a;
      color:#fff;
      border:none;
      border-radius:6px;
      cursor:pointer;
    ">Login</button>
  </div>
</div>


<div class="app" id="app" style="display:none">

  <!-- SIDEBAR -->
  <aside class="sidebar">
    <h2>Catatan</h2>
    <textarea class="note" placeholder="Tulis catatan bulanan..."></textarea>

    <h3>Kegiatan</h3>
    <div class="legend">
      <div><span class="color bem"></span>Acara BEM</div>
      <div><span class="color proker"></span>Proker Harian</div>
      <div><span class="color rapat"></span>Rapat Harian</div>
      <div><span class="color bulanan"></span>Rapat Bulanan</div>
      <div><span class="color libur"></span>Libur Nasional</div>
    </div>

    <button onclick="logout()" style="margin-top:10px;width:100%">Logout</button>

  </aside>

  <!-- MAIN -->
  <main class="main">
    <div class="header">
      <h1 id="monthYear"></h1>
      <div class="nav">
        <button onclick="prevMonth()">◀</button>
        <button onclick="nextMonth()">▶</button>
      </div>
    </div>

    <div class="calendar">
      <div class="weekdays">
        <div>Sun</div><div>Mon</div><div>Tue</div>
        <div>Wed</div><div>Thu</div><div>Fri</div><div>Sat</div>
      </div>
      <div class="days" id="days"></div>
    </div>
  </main>
</div>

<!-- MODAL -->
<div class="modal" id="modal">
  <div class="modal-content">
    <h3>Agenda</h3>
    <input id="title" placeholder="Nama agenda">
    <select id="type">
      <option value="bem">Acara BEM</option>
      <option value="proker">Proker Harian</option>
      <option value="rapat">Rapat Harian</option>
      <option value="bulanan">Rapat Bulanan</option>
    </select>
    <button onclick="saveEvent()">Simpan</button>
    <button onclick="deleteEvent()">Hapus</button>
    <button onclick="closeModal()">Tutup</button>
  </div>
</div>

<script>
/* ================== DATA DASAR ================== */
const months = [
  "Januari","Februari","Maret","April","Mei","Juni",
  "Juli","Agustus","September","Oktober","November","Desember"
];

let current = new Date(2026, 0);
let selectedDate = "";

/* ================== LIBUR NASIONAL ================== */
const holidays = {
  "2026-01-01":"Tahun Baru",
  "2026-01-16":"Isra Mi'raj",
  "2026-02-17":"Tahun Baru Imlek",
  "2026-03-19":"Nyepi",
  "2026-03-20":"Nyepi",
  "2026-04-03":"Wafat Isa Almasih",
  "2026-05-01":"Hari Buruh",
  "2026-05-14":"Kenaikan Isa Almasih",
  "2026-05-25":"Idul Fitri",
  "2026-05-26":"Idul Fitri",
  "2026-06-01":"Hari Lahir Pancasila",
  "2026-07-20":"Idul Adha",
  "2026-08-17":"Kemerdekaan RI",
  "2026-09-24":"Maulid Nabi",
  "2026-12-25":"Natal"
};

/* ================== EVENT STATE ================== */
const events = {};

/* ================== RENDER KALENDER ================== */
function render(){
  const days = document.getElementById("days");
  days.innerHTML = "";

  document.getElementById("monthYear").innerText =
    months[current.getMonth()] + " 2026";

  const first = new Date(2026, current.getMonth(), 1).getDay();
  const total = new Date(2026, current.getMonth() + 1, 0).getDate();

  for(let i = 0; i < first; i++){
    days.innerHTML += `<div class="day"></div>`;
  }

  for(let d = 1; d <= total; d++){
    const date =
      `2026-${String(current.getMonth()+1).padStart(2,"0")}-${String(d).padStart(2,"0")}`;

    let html = `<div class="day" onclick="openModal('${date}')">
                  <span>${d}</span>`;

    if(holidays[date]){
      html += `<div class="event libur">${holidays[date]}</div>`;
    }

    if(events[date]){
      html += `<div class="event ${events[date].type}">
                 ${events[date].title}
               </div>`;
    }

    html += `</div>`;
    days.innerHTML += html;
  }
}

/* ================== FIRESTORE ================== */
async function loadEvents(){
  const snap = await getDocs(collection(db, "events"));
  snap.forEach(docu => {
    events[docu.id] = docu.data();
  });
  render();
}

async function saveEvent(){
  if(!selectedDate) return;

  const data = {
    title: document.getElementById("title").value,
    type: document.getElementById("type").value,
    date: selectedDate,
    year: 2026
  };

  await setDoc(
    doc(db, "events", selectedDate),
    data
  );

  events[selectedDate] = data;
  closeModal();
  render();
}

async function deleteEvent(){
  if(!selectedDate) return;

  await deleteDoc(
    doc(db, "events", selectedDate)
  );

  delete events[selectedDate];
  closeModal();
  render();
}

/* ================== MODAL ================== */
function openModal(date){
  selectedDate = date;
  document.getElementById("modal").style.display = "flex";
  document.getElementById("title").value = events[date]?.title || "";
  document.getElementById("type").value = events[date]?.type || "bem";
}

function closeModal(){
  document.getElementById("modal").style.display = "none";
}

/* ================== NAV BULAN ================== */
function prevMonth(){
  current.setMonth(current.getMonth() - 1);
  render();
}

function nextMonth(){
  current.setMonth(current.getMonth() + 1);
  render();
}

/* ================== LOGIN DUMMY ================== */
const USER_EMAIL = "bem@bem.com";
const USER_PASSWORD = "bemkuat";

function login(){
  const email = document.getElementById("loginEmail").value;
  const password = document.getElementById("loginPassword").value;

  if(email === USER_EMAIL && password === USER_PASSWORD){
    localStorage.setItem("bemLogin", "true");
    showApp();
  } else {
    alert("Email atau password salah!");
  }
}

function logout(){
  localStorage.removeItem("bemLogin");
  location.reload();
}

function showApp(){
  document.getElementById("loginPage").style.display = "none";
  document.getElementById("app").style.display = "grid";
}

function checkLogin(){
  if(localStorage.getItem("bemLogin") === "true"){
    showApp();
  }
}

/* ================== INIT ================== */
checkLogin();
loadEvents();
</script>


</body>
</html>
